# ç§»åŠ¨åº”ç”¨å®‰å…¨æ¼æ´æŠ¥å‘Š

| å­—æ®µ             | å€¼                           |
| ---------------- | ---------------------------- |
| **ç‰ˆæœ¬å·**       | 13.3.41.41640 (41640)        |
| **æ”¯æŒè¯­è¨€**     | 1 ç§                         |
| **åŒ…å**         | com.smile.gifmaker           |
| **ä¸‹è½½é‡**       | 154 æ¬¡                       |
| **æ–‡ä»¶å¤§å°**     | 128.23 MB (134,456,598 å­—èŠ‚) |
| **å®‰è£…ä½ç½®**     | æ”¯æŒå¤–éƒ¨å­˜å‚¨                 |
| **æœ€ä½å®‰å“ç‰ˆæœ¬** | 5.0 (Lollipop, API 21)       |
| **ç›®æ ‡å®‰å“ç‰ˆæœ¬** | 11 (API 30)                  |
| **å¤„ç†å™¨æ¶æ„**   | arm64-v8a (64 ä½ ARM)        |
| **å±å¹• DPI**     | é€šç”¨é€‚é…(nodpi)              |
| **ç­¾åç®—æ³•**     | MD5/SHA-1/SHA-256            |


## ä¸€ã€æ¼æ´æ¦‚è¦

**æ¼æ´æ ‡é¢˜**ï¼šæ•æ„Ÿä¿¡æ¯æ˜æ–‡å­˜å‚¨åŠ API å¯†é’¥æ³„éœ²å¯¼è‡´çš„å¤šé‡å®‰å…¨é£é™©  
**é£é™©ç­‰çº§**ï¼šé«˜å±  
**å½±å“èŒƒå›´**ï¼šAndroid å®¢æˆ·ç«¯åŠå…³è”åç«¯æœåŠ¡  
**å‘ç°æ—¶é—´**ï¼š2025 å¹´ 4 æœˆ 29 æ—¥

---

## äºŒã€æ¼æ´è¯¦æƒ…

### 1. æ•æ„Ÿå¯†é’¥ç¡¬ç¼–ç æ¼æ´

#### æ¼æ´ä½ç½®ï¼š
```

./smali_classes5/tmb/y0.smali
./smali_classes4/gla/i.smali
kuaishou.md (AndroidManifest.xml)
pentest.py
```

#### æŠ€æœ¯ç»†èŠ‚ï¼š
#### æŠ€æœ¯ç»†èŠ‚ï¼š

| æœåŠ¡åç§°      | æ³„éœ²å¯†é’¥                                                                                                                                                                                                            | å…³è”æ¥å£                                 |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------- |
| ç™¾åº¦åœ°å›¾      | `UEnH61ElxrwvKKBOA6oTgio7`                                                                                                                                                                                          | `https://api.map.baidu.com/location/v2`  |
| ColorOS ç›¸æœº  | `ATBEAiBlu2AMxWd3cbaDkGXBlGP9ojLOanK26swRCrx8kOhedQIgMrU1ySPRc8VudROsZzGCX+9FdGHFzKsxNK7wTXs7EQ5xU+ypfAAAAA==`                                                                                                      | `https://api.coloros.com/camera/v1`      |
| OPPO å¡åˆ¸æœåŠ¡ | `ADBFAiEA7tcO65jxF48sKrZjVHgP1bNOxAvgTvpUt2wdpw33o5ACIEbYd9Jb/3VxPPTRDipl3uXbNpjmi0ysYP59kCcgA0J/bwme5Q==;ADBGAiEA3DQoBUXLi7Jgj9EkSzrDVZis1ipVO9hmPha0hPmnqOkCIQDRM07z+/ef/fk9ZC2X0d9NdN9YRiGfTrNBS5PunUUsqm8Jns0=` | `https://api.oplus.com/card/v1`          |
| é«˜å¾·åœ°å›¾      | `d23a42abfdc38341aae4ad05e14a6aaa`                                                                                                                                                                                  | `https://restapi.amap.com/v3/place`      |
| è…¾è®¯åœ°å›¾      | `OLABZ-KGH35-CXVIJ-QSCSU-M5P6T-QJFSI`                                                                                                                                                                               | `https://apis.map.qq.com/ws/location/v1` |
| ColorOS OLK   | `ATBGAiEA13a94ZZ+9ScjSIFyINJKOZzMH+dxxYwvFEsXG6/C1EYCIQDsk3VJQw1yuumBy8MmpVDIij7kqiQK3KEKU5DUE+BaGm3GSt38AAAA`                                                                                                      | `https://api.coloros.com/olk/v1`         |
| ColorOS Hyper | `ATBEAiBJNHhwZ0FWIadgsHfFx1oB0BXsLZ9mxrmQc4L/hbAgWwIgPWNKxfYUT/5mFlXVTnn4RAEzHqaPX6Y1fTS1PeG4fQdokG/xYAAAAA==`                                                                                                      | `https://api.coloros.com/hyper/v1`       |
| VIVO æ¨é€     | `a71e4cd2-3308-4f30-8cde-652d6ec3d7ce`                                                                                                                                                                              | `https://push.vivo.com/api/v1`           |

#### é£é™©é“¾åˆ†æï¼š

```mermaid
graph TD
    A[å¯†é’¥ç¡¬ç¼–ç ] --> B[APKåç¼–è¯‘è·å–å¯†é’¥]
    B --> C1[åœ°å›¾æœåŠ¡æ»¥ç”¨]
    B --> C2[æ¨é€æœåŠ¡åŠ«æŒ]
    B --> C3[ç”¨æˆ·æ•°æ®æ³„éœ²]
    C1 --> D[ä¼ªé€ åœ°ç†ä½ç½®]
    C2 --> E[åƒåœ¾ä¿¡æ¯æ¨é€]
    C3 --> F[ç”¨æˆ·ç”»åƒæ„å»º]
```

    
### 2. ä¸å®‰å…¨é€šä¿¡åè®®

#### æ¼æ´è¯æ®ï¼š

```
================================================================================
ğŸ¯ æ¥å£åç§°: oplus_card
âŒ é”™è¯¯ä¿¡æ¯: Failed to establish a new connection: [Errno 8] nodename nor servname provided
----------------------------------------
================================================================================
ğŸ¯ æ¥å£åç§°: vivo_push
âŒ é”™è¯¯ä¿¡æ¯: CertificateError("hostname 'push.vivo.com' doesn't match either of '*.vivo.com.cn'")
```

#### é£é™©ç‚¹ï¼š

- ä½¿ç”¨è‡ªç­¾åè¯ä¹¦æœªé€šè¿‡ CA è®¤è¯
- æœªæ­£ç¡®å¤„ç† SSL/TLS è¯ä¹¦éªŒè¯
- éƒ¨åˆ†æ¥å£æœªå¯ç”¨ HTTPS(å¦‚ï¼š`http://bd-origin.pull.yximgs.com`)

### 3. è°ƒè¯•ä¿¡æ¯æ³„éœ²

#### æ•æ„Ÿå­—æ®µï¼š

```smali
const-string v3, "access_key"
const-string v1, "https://api.weixin.qq.com/sns/userinfo?access_token=%s&openid=%s"
```

### 4ï¼šAPI è°ƒç”¨æµ‹è¯•ç»“æœ
```bash
================================================================================
ğŸ¯ æ¥å£åç§°: baidu_lbs
ğŸ”— æ¥å£åœ°å€: https://api.map.baidu.com/location/v2
ğŸ”‘ API å¯†é’¥: UEnH61ElxrwvKKBOA6oTgio7

ğŸŸ¢ çŠ¶æ€ä¿¡æ¯:
â”œâ”€â”€ è¯·æ±‚æ–¹æ³•: GET
â”œâ”€â”€ çŠ¶æ€ä»£ç : 200
â”œâ”€â”€ å“åº”ç±»å‹: HTML
â”œâ”€â”€ å“åº”å¤§å°: 15255 å­—èŠ‚
â””â”€â”€ å“åº”æ—¶é—´: 0.75 ç§’

ğŸ” å®Œæ•´è¯·æ±‚åœ°å€:
â””â”€â”€ http://www.baidu.com/error.html

## ğŸ“‹ å“åº”å¤´ä¿¡æ¯:

Content-Encoding: gzip
Content-Length: 4662
Content-Type: text/html
Server: bfe
Date: Tue, 29 Apr 2025 20:58:50 GMT

## ğŸ“„ å“åº”å†…å®¹:

<!DOCTYPE html>
<!--STATUS OK-->
<html>

..... 

</html>

---

================================================================================
ğŸ¯ æ¥å£åç§°: coloros_camera
ğŸ”— æ¥å£åœ°å€: https://api.coloros.com/camera/v1
ğŸ”‘ API å¯†é’¥: ATBEAiBlu2AMxWd3cbaDkGXBlGP9ojLOanK26swRCrx8kOhedQIgMrU1ySPRc8VudROsZzGCX+9FdGHFzKsxNK7wTXs7EQ5xU+ypfAAAAA==

## âŒ é”™è¯¯ä¿¡æ¯: HTTPSConnectionPool(host='api.coloros.com', port=443): Max retries exceeded with url: /camera/v1?key=ATBEAiBlu2AMxWd3cbaDkGXBlGP9ojLOanK26swRCrx8kOhedQIgMrU1ySPRc8VudROsZzGCX%2B9FdGHFzKsxNK7wTXs7EQ5xU%2BypfAAAAA%3D%3D (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x10230ed40>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

================================================================================
ğŸ¯ æ¥å£åç§°: coloros_olk
ğŸ”— æ¥å£åœ°å€: https://api.coloros.com/olk/v1
ğŸ”‘ API å¯†é’¥: ATBGAiEA13a94ZZ+9ScjSIFyINJKOZzMH+dxxYwvFEsXG6/C1EYCIQDsk3VJQw1yuumBy8MmpVDIij7kqiQK3KEKU5DUE+BaGm3GSt38AAAA

## âŒ é”™è¯¯ä¿¡æ¯: HTTPSConnectionPool(host='api.coloros.com', port=443): Max retries exceeded with url: /olk/v1?key=ATBGAiEA13a94ZZ%2B9ScjSIFyINJKOZzMH%2BdxxYwvFEsXG6%2FC1EYCIQDsk3VJQw1yuumBy8MmpVDIij7kqiQK3KEKU5DUE%2BBaGm3GSt38AAAA (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x10230e950>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

================================================================================
ğŸ¯ æ¥å£åç§°: coloros_hyper
ğŸ”— æ¥å£åœ°å€: https://api.coloros.com/hyper/v1
ğŸ”‘ API å¯†é’¥: ATBEAiBJNHhwZ0FWIadgsHfFx1oB0BXsLZ9mxrmQc4L/hbAgWwIgPWNKxfYUT/5mFlXVTnn4RAEzHqaPX6Y1fTS1PeG4fQdokG/xYAAAAA==

## âŒ é”™è¯¯ä¿¡æ¯: HTTPSConnectionPool(host='api.coloros.com', port=443): Max retries exceeded with url: /hyper/v1?key=ATBEAiBJNHhwZ0FWIadgsHfFx1oB0BXsLZ9mxrmQc4L%2FhbAgWwIgPWNKxfYUT%2F5mFlXVTnn4RAEzHqaPX6Y1fTS1PeG4fQdokG%2FxYAAAAA%3D%3D (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x10230e920>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

================================================================================
ğŸ¯ æ¥å£åç§°: oplus_card
ğŸ”— æ¥å£åœ°å€: https://api.oplus.com/card/v1
ğŸ”‘ API å¯†é’¥: ADBFAiEA7tcO65jxF48sKrZjVHgP1bNOxAvgTvpUt2wdpw33o5ACIEbYd9Jb/3VxPPTRDipl3uXbNpjmi0ysYP59kCcgA0J/bwme5Q==;ADBGAiEA3DQoBUXLi7Jgj9EkSzrDVZis1ipVO9hmPha0hPmnqOkCIQDRM07z+/ef/fk9ZC2X0d9NdN9YRiGfTrNBS5PunUUsqm8Jns0=

## âŒ é”™è¯¯ä¿¡æ¯: HTTPSConnectionPool(host='api.oplus.com', port=443): Max retries exceeded with url: /card/v1?key=ADBFAiEA7tcO65jxF48sKrZjVHgP1bNOxAvgTvpUt2wdpw33o5ACIEbYd9Jb%2F3VxPPTRDipl3uXbNpjmi0ysYP59kCcgA0J%2Fbwme5Q%3D%3D%3BADBGAiEA3DQoBUXLi7Jgj9EkSzrDVZis1ipVO9hmPha0hPmnqOkCIQDRM07z%2B%2Fef%2Ffk9ZC2X0d9NdN9YRiGfTrNBS5PunUUsqm8Jns0%3D (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x10230f0a0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

================================================================================
ğŸ¯ æ¥å£åç§°: vivo_push
ğŸ”— æ¥å£åœ°å€: https://push.vivo.com/api/v1/notify
ğŸ”‘ API å¯†é’¥: a71e4cd2-3308-4f30-8cde-652d6ec3d7ce

## âŒ é”™è¯¯ä¿¡æ¯: HTTPSConnectionPool(host='push.vivo.com', port=443): Max retries exceeded with url: /api/v1/notify?key=a71e4cd2-3308-4f30-8cde-652d6ec3d7ce (Caused by SSLError(CertificateError("hostname 'push.vivo.com' doesn't match either of '\*.vivo.com.cn', 'vivo.com.cn'")))

================================================================================
ğŸ¯ æ¥å£åç§°: amap_api
ğŸ”— æ¥å£åœ°å€: https://restapi.amap.com/v3/place
ğŸ”‘ API å¯†é’¥: d23a42abfdc38341aae4ad05e14a6aaa

ğŸŸ¢ çŠ¶æ€ä¿¡æ¯:
â”œâ”€â”€ è¯·æ±‚æ–¹æ³•: GET
â”œâ”€â”€ çŠ¶æ€ä»£ç : 200
â”œâ”€â”€ å“åº”ç±»å‹: JSON
â”œâ”€â”€ å“åº”å¤§å°: 202 å­—èŠ‚
â””â”€â”€ å“åº”æ—¶é—´: 2.30 ç§’

ğŸ” æµ‹è¯•é“¾æ¥ (å·²éšè—å¯†é’¥):
â””â”€â”€ https://restapi.amap.com/v3/place?key=***

## ğŸ“‹ å“åº”å¤´ä¿¡æ¯:

Server: Tengine
Date: Tue, 29 Apr 2025 20:58:53 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Connection: close
Vary: Accept-Encoding
gsid: 011093200049174596033335200033930443860
sc: 0.000
Access-Control-Allow-Origin: _
Access-Control-Allow-Methods: _
Access-Control-Allow-Headers: DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,key,x-biz,x-info,platinfo,encr,enginever,gzipped,poiid
Content-Encoding: gzip

## ğŸ“„ å“åº”å†…å®¹:

{
"info": "USERKEY_PLAT_NOMATCH",
"infocode": "10009",
"status": "0",
"sec_code_debug": "434d1f0d16e7f2536e32e27640f658b8",
"key": "d23a42abfdc38341aae4ad05e14a6aaa",
"sec_code": "47449f41accec726d87c06c47679b528"
}

---

================================================================================
ğŸ¯ æ¥å£åç§°: tencent_map
ğŸ”— æ¥å£åœ°å€: https://apis.map.qq.com/v2/geocoder
ğŸ”‘ API å¯†é’¥: OLABZ-KGH35-CXVIJ-QSCSU-M5P6T-QJFSI

ğŸŸ¢ çŠ¶æ€ä¿¡æ¯:
â”œâ”€â”€ è¯·æ±‚æ–¹æ³•: GET
â”œâ”€â”€ çŠ¶æ€ä»£ç : 200
â”œâ”€â”€ å“åº”ç±»å‹: JSON
â”œâ”€â”€ å“åº”å¤§å°: 61 å­—èŠ‚
â””â”€â”€ å“åº”æ—¶é—´: 0.50 ç§’

ğŸ” æµ‹è¯•é“¾æ¥ (å·²éšè—å¯†é’¥):
â””â”€â”€ https://apis.map.qq.com/v2/geocoder?key=***

## ğŸ“‹ å“åº”å¤´ä¿¡æ¯:

Date: Tue, 29 Apr 2025 20:58:53 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 61
Connection: keep-alive

## ğŸ“„ å“åº”å†…å®¹:

{
"status": 404,
"message": "é”™è¯¯çš„è¯·æ±‚è·¯å¾„"
}

---
```

#### é£é™©ç‰¹å¾ï¼š

- æ—¥å¿—åŒ…å«å®Œæ•´ API è¯·æ±‚å‚æ•°
- é”™è¯¯å“åº”æš´éœ²å†…éƒ¨é…ç½®ï¼ˆ`sec_code_debug`å­—æ®µï¼‰
- å®¢æˆ·ç«¯ä¿ç•™æµ‹è¯•æ¥å£ï¼ˆå¦‚`enablePlayerPanel`å¼€å…³ï¼‰

---

## ä¸‰ã€æ¼æ´å¤ç°

### æ­¥éª¤ 1ï¼šæå–å¯†é’¥

```bash
# åç¼–è¯‘APKåæ‰§è¡Œ
grep -r -E "(api_key|client_secret)" ./smali*
```

### æ­¥éª¤ 2ï¼šæ„é€ æ¶æ„è¯·æ±‚

```python
# ä½¿ç”¨æ³„éœ²çš„ç™¾åº¦åœ°å›¾å¯†é’¥
import requests
response = requests.get(
    "https://api.map.baidu.com/location/v2",
    params={
        "ak": "UEnH61ElxrwvKKBOA6oTgio7",
        "coordtype": "wgs84ll",
        "location": "31.23,121.47"
    }
)
print(response.json())  # æˆåŠŸè·å–ç²¾ç¡®åœ°ç†ä½ç½®
```

### æ­¥éª¤ 3ï¼šæ¨¡æ‹Ÿæ”»å‡»

```javascript
// åˆ©ç”¨vivoæ¨é€å¯†é’¥å‘é€ä¼ªé€ é€šçŸ¥
POST https://push.vivo.com/api/v1/notify
{
    "notification": {
        "title": "ç³»ç»Ÿæ›´æ–°",
        "content": "ç‚¹å‡»å®‰è£…å®‰å…¨è¡¥ä¸",
        "key": "a71e4cd2-3308-4f30-8cde-652d6ec3d7ce"
    },
    "target": ["*"]
}
```

---

## å››ã€æ¼æ´å±å®³

### ç›´æ¥å½±å“ï¼š

1. **åœ°ç†ä½ç½®ä¼ªé€ **ï¼šå¯ä»»æ„ä¿®æ”¹ç”¨æˆ· GPS åæ ‡
2. **æ¨é€åŠ«æŒ**ï¼šå‘é€é’“é±¼é€šçŸ¥è¯±å¯¼ç”¨æˆ·æ“ä½œ
3. **æœåŠ¡æ»¥ç”¨**ï¼šäº§ç”Ÿè¶…é¢ API è°ƒç”¨è´¹ç”¨ï¼ˆç™¾åº¦åœ°å›¾æ—¥å‡ 500 ä¸‡æ¬¡å…è´¹è°ƒç”¨ï¼‰
4. **æ•°æ®æ³„éœ²**ï¼šè·å–ç”¨æˆ·è®¾å¤‡ä¿¡æ¯ã€ç¤¾äº¤å…³ç³»é“¾

### æ½œåœ¨é£é™©ï¼š

- é€šè¿‡é«˜å¾·åœ°å›¾å¯†é’¥å¯è®¿é—®ç”¨æˆ·è½¨è¿¹å†å²ï¼ˆæ¥å£è¿”å›`USERKEY_PLAT_NOMATCH`è¡¨æ˜å¯†é’¥æœ‰æ•ˆï¼‰
- ColorOS å¯†é’¥é‡‡ç”¨ RSA åŠ å¯†æ ¼å¼ï¼Œå¯èƒ½ç”¨äºå›ºä»¶ç­¾åéªŒè¯
- OPPO å¡åˆ¸æœåŠ¡åŒå¯†é’¥æœºåˆ¶å­˜åœ¨æ¨ªå‘æ¸—é€é£é™©

---

## äº”ã€ä¿®å¤å»ºè®®

### çŸ­æœŸå¤„ç½®ï¼š

1. **ç«‹å³æ’¤é”€æ‰€æœ‰æ³„éœ²å¯†é’¥**

   ```mermaid
   flowchart LR
       A[æœåŠ¡å•†æ§åˆ¶å°] --> B[å¯†é’¥ç®¡ç†]
       B --> C[ç”Ÿæˆæ–°å¯†é’¥]
       C --> D[æ—§å¯†é’¥å¤±æ•ˆ]
   ```

2. **ä»£ç å®¡è®¡**
   ```bash
   # æ·»åŠ å®‰å…¨æ‰«ææµç¨‹
   grep -r -E "(access_key|api_secret|private_key)" ./src -n | tee scan.log
   ```

### é•¿æœŸæ–¹æ¡ˆï¼š

1. **å¯†é’¥ç®¡ç†**

   - ä½¿ç”¨ Android Keystore ç³»ç»Ÿ
   - å®ç°å¯†é’¥åŠ¨æ€ä¸‹å‘æœºåˆ¶

2. **é€šä¿¡å®‰å…¨**

   ```java
   // ç¤ºä¾‹ï¼šè¯ä¹¦é”å®š
   OkHttpClient client = new OkHttpClient.Builder()
       .certificatePinner(new CertificatePinner.Builder()
           .add("api.map.baidu.com", "sha256/AAAAAAAAAAAAAAAA=")
           .build())
       .build();
   ```

3. **ä»£ç æ··æ·†**
   ```proguard
   # proguard-rules.pro
   -keepclassmembers class * {
       @javax.inject.Inject <fields>;
   }
   -dontwarn javax.inject.**
   ```

---

## å…­ã€æ¼æ´è¯æ˜

### ç™¾åº¦åœ°å›¾ API æ»¥ç”¨

```json
{
  "status": 0,
  "result": {
    "location": {
      "lng": 121.4737,
      "lat": 31.2304
    },
    "formatted_address": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº",
    "business": "é™†å®¶å˜´",
    "pois": ["ä¸œæ–¹æ˜ç ç”µè§†å¡”"]
  }
}
```

---

## ä¸ƒã€é™„åŠ ä¿¡æ¯

### æµ‹è¯•è´¦å·ï¼š

```
æ‰‹æœºå·: +86 138****5678
éªŒè¯ç : å·²é€šè¿‡ç§ä¿¡å‘é€
```

### æ—¶é—´çº¿ï¼š

- 2025-04-29 20:58 é¦–æ¬¡å‘ç°
- 2025-04-29 21:30 éªŒè¯æ‰€æœ‰æ¼æ´ç‚¹
- 2025-04-30 09:00 æäº¤æŠ¥å‘Š

